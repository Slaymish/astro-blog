---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  const reports = await getCollection('reports');
  return reports.map(report => ({
    params: { slug: report.slug },
    props: { report },
  }));
}

const { report } = Astro.props;
const { data, render } = report;
const { Content } = await render();
---

<Layout title={data.title}>
  <main>
    <article>
      <h1>{data.title}</h1>
      <div class="meta">
        <time>
          {new Date(data.date).toLocaleDateString()}
        </time>
        {data.tags && (
          <div class="tags">
            {data.tags.map(tag => (
              <span class="tag">{tag}</span>
            ))}
          </div>
        )}
      </div>
      
      {data.pdfPath && (
        <div class="pdf-container">
          <iframe 
            src={data.pdfPath}
            width="100%" 
            height="800px"
            style="border: none;"
          />
        </div>
      )}

      {data.pdfPath && (
        <a href={data.pdfPath} download class="download-btn">
          Download PDF Report
        </a>
      )}

      <Content />
    </article>
  </main>
</Layout>

<style>
  .pdf-container {
    max-width: 100%;
    margin: 2rem 0;
  }
  
  .download-btn {
    display: inline-block;
    padding: 0.5rem 1rem;
    background: var(--accent);
    color: white;
    text-decoration: none;
    border-radius: 4px;
    margin: 1rem 0;
  }
</style>
