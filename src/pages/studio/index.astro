---
/**
 * Studio Landing Page
 * Zero JavaScript - static only
 */

import StudioLayout from '../../studio/StudioLayout.astro';
import { fetchSanity } from '../../lib/sanity';

export const prerender = false;

type AphorismDoc = {
  title: string;
  subtitle?: string;
  text?: string;
  slug: string;
  tags?: string[];
  publishedAt?: string;
};

const aphorisms = await fetchSanity<AphorismDoc[]>(`
  *[_type == "aphorism" && status == "published"] | order(publishedAt desc){
    title,
    subtitle,
    text,
    tags,
    publishedAt,
    "slug": slug.current
  }
`);
---

<StudioLayout title="Studio" palette="noir" motion="subtle">
  <div class="studio-landing">
    <!-- Manifesto -->
    <section class="manifesto">
      <h1 class="manifesto-title">Studio</h1>
      <div class="manifesto-body">
        <p>
        Where overthinking goes to be edited down.  
        </p>
    </div>
    </section>

    <!-- Aphorism list -->
    <section class="aphorism-list">
      <h2 class="aphorism-list-title">Aphorisms</h2>
      
      {aphorisms.length === 0 ? (
        <p class="aphorism-list-empty">No aphorisms yet. Check back soon.</p>
      ) : (
        <ul class="aphorisms" role="list">
          {aphorisms.map((aphorism) => (
            <li class="aphorism-item">
              <a href={`/studio/${aphorism.slug}`} class="aphorism-link">
                <div class="aphorism-header">
                  <h3 class="aphorism-title">{aphorism.title}</h3>
                  {aphorism.subtitle && (
                    <p class="aphorism-subtitle">{aphorism.subtitle}</p>
                  )}
                </div>
                {aphorism.text && (
                  <p class="aphorism-text">{aphorism.text}</p>
                )}
                <div class="aphorism-meta">
                  {aphorism.publishedAt && (
                    <time 
                      datetime={new Date(aphorism.publishedAt).toISOString()}
                      class="aphorism-date"
                    >
                      {new Date(aphorism.publishedAt).toLocaleDateString('en-US', { 
                        year: 'numeric', 
                        month: 'long',
                        day: 'numeric' 
                      })}
                    </time>
                  )}
                  {aphorism.tags && aphorism.tags.length > 0 && (
                    <div class="aphorism-tags">
                      {aphorism.tags.map(tag => (
                        <span class="aphorism-tag">{tag}</span>
                      ))}
                    </div>
                  )}
                </div>
              </a>
            </li>
          ))}
        </ul>
      )}
    </section>
  </div>

  <style>
    .studio-landing {
      max-width: 800px;
      margin: 0 auto;
    }

    /* Manifesto */
    .manifesto {
      margin-bottom: var(--studio-space-24);
      opacity: 0;
      animation: fadeIn var(--studio-duration-slow) var(--studio-ease-out) forwards;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .manifesto-title {
      font-family: var(--studio-font-sans);
      font-size: var(--studio-text-5xl);
      font-weight: 300;
      letter-spacing: var(--studio-tracking-tight);
      color: var(--studio-text-primary);
      margin-bottom: var(--studio-space-8);
    }

    .manifesto-body {
      font-size: var(--studio-text-xl);
      line-height: var(--studio-leading-relaxed);
      color: var(--studio-text-secondary);
    }

    .manifesto-body p {
      margin-bottom: var(--studio-space-6);
    }

    .manifesto-body p:last-child {
      margin-bottom: 0;
    }

    /* Aphorism list */
    .aphorism-list {
      border-top: 1px solid var(--studio-border);
      padding-top: var(--studio-space-8);
    }

    .aphorism-list-title {
      font-family: var(--studio-font-sans);
      font-size: var(--studio-text-sm);
      font-weight: 600;
      letter-spacing: var(--studio-tracking-wider);
      text-transform: uppercase;
      color: var(--studio-text-muted);
      margin-bottom: var(--studio-space-8);
    }

    .aphorism-list-empty {
      font-size: var(--studio-text-base);
      color: var(--studio-text-muted);
      font-style: italic;
    }

    .aphorisms {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .aphorism-item {
      margin-bottom: var(--studio-space-12);
      opacity: 0;
      animation: fadeIn var(--studio-duration-slow) var(--studio-ease-out) forwards;
    }

    .aphorism-item:nth-child(1) { animation-delay: 100ms; }
    .aphorism-item:nth-child(2) { animation-delay: 200ms; }
    .aphorism-item:nth-child(3) { animation-delay: 300ms; }
    .aphorism-item:nth-child(4) { animation-delay: 400ms; }
    .aphorism-item:nth-child(5) { animation-delay: 500ms; }

    .aphorism-link {
      display: block;
      padding: var(--studio-space-6);
      border: 1px solid transparent;
      border-radius: 4px;
      text-decoration: none;
      transition: all var(--studio-duration-normal) var(--studio-ease-out);
    }

    .aphorism-link:hover {
      border-color: var(--studio-border);
      background-color: var(--studio-bg-secondary);
      transform: translateX(4px);
    }

    .aphorism-link:focus-visible {
      outline: 2px solid var(--studio-accent);
      outline-offset: 2px;
      border-color: var(--studio-accent-dim);
    }

    .aphorism-header {
      margin-bottom: var(--studio-space-4);
    }

    .aphorism-title {
      font-family: var(--studio-font-sans);
      font-size: var(--studio-text-2xl);
      font-weight: 600;
      letter-spacing: var(--studio-tracking-tight);
      color: var(--studio-text-primary);
      margin-bottom: var(--studio-space-2);
    }

    .aphorism-subtitle {
      font-family: var(--studio-font-sans);
      font-size: var(--studio-text-base);
      color: var(--studio-text-muted);
      margin-bottom: 0;
    }

    .aphorism-text {
      color: var(--studio-text-secondary);
      font-size: var(--studio-text-base);
      margin-bottom: var(--studio-space-4);
    }

    .aphorism-meta {
      display: flex;
      gap: var(--studio-space-4);
      align-items: center;
      flex-wrap: wrap;
      font-family: var(--studio-font-mono);
      font-size: var(--studio-text-xs);
      color: var(--studio-text-muted);
    }

    .aphorism-tags {
      display: flex;
      gap: var(--studio-space-2);
      flex-wrap: wrap;
    }

    .aphorism-tag {
      font-size: var(--studio-text-xs);
      color: var(--studio-text-muted);
      background-color: var(--studio-bg-tertiary);
      padding: var(--studio-space-1) var(--studio-space-2);
      border-radius: 3px;
    }
  </style>
</StudioLayout>
